---
description: 
globs: 
alwaysApply: true
---
# Time Weighted Return Portfolio Analytics Tool

## Project Vision
This is a private wealth management tool for calculating portfolio performance metrics including Time Weighted Return (TWR), Contribution, and Attribution analysis. The system supports hierarchical portfolio structures (Client → Portfolio → Account) with multi-currency support using GBP as the base currency.

## Core Financial Calculations

### Time Weighted Return (TWR)
For each sub-period i: `Ri = (Vi,end - Vi,start - Fi) / Vi,start`
Chain them: `TWR = ∏(1 + Ri) - 1`

### Contribution Analysis
Contribution of instrument j in period t: `Cj,t = wj,t-1 × Rj,t`

### Attribution Analysis (Brinson-Fachler)
- **Allocation Effect**: `(wj - wjB) × RjB`
- **Selection Effect**: `wjB × (Rj - RjB)`
- **Interaction Effect**: `(wj - wjB) × (Rj - RjB)`

## Architecture Stack
- **Frontend**: React + Vite + TypeScript + RTK Query
- **Backend**: .NET Core + MediatR + Entity Framework Core
- **Database**: MS SQL Server (Code First)
- **Testing**: TDD approach with xUnit (.NET) and Vitest (React)

## Key Features
- Hierarchical tree-view UI for portfolio navigation
- Multi-currency support with daily FX rates
- Security and Cash position tracking
- Real-time performance calculations
- Clean, modern, user-friendly interface

